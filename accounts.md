# Аккаунты и разрешения

Аккаунт - это учетная запись пользователя или группы пользователей, с помощью которой совершаются все операции в блокчейне VIZ. Каждому аккаунту в качестве идентификатора присваивается уникальное, доступное для человеческого восприятия имя длиной от 2 до 25 символов латинского алфавиты. Кроме того, имена аккаунтов могут указывать на пространства имен(домен), которые отделяются точкой. При этом только владелец домена может создать поддомен(например только аккаунт @domain может создать аккаунт @subdomain.domain). По умолчанию аккаунтом владеет только один человек и он должен прописать в нем четыре публичных ключа: главный ключ, активный ключ, регулярный ключ и коммуникативный ключ. Каждый публичный ключ должен быть создан из разных приватных ключей, используя алгоритм на базе эллиптической криптографии для кривой [secp256k1](https://en.bitcoin.it/wiki/Secp256k1)(такая же кривая используется в Bitcoin).

*Ниже в таблице приведены параметры для secp256k1*

| Параметр | Значение                                                     |
| -------- | ------------------------------------------------------------ |
| p        | 0xffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f |
| a        | 0                                                            |
| b        | 7                                                            |
| Gx       | 0x79be667e f9dcbbac 55a06295 ce870b07 029bfcdb 2dce28d9 59f2815b 16f81798 |
| Gy       | 0x483ada77 26a3c465 5da4fbfc 0e1108a8 fd17b448 a6855419 9c47d08f fb10d4b8 |
| n        | 0xffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141 |
| h        | 1                                                            |

Каждый раз, когда пользователь отправляет транзакцию от имени аккаунта, он должен подпись ее по алгоритму [ECDSA](https://ru.wikipedia.org/wiki/ECDSA) одним из трех приватных ключей, который соответствует главному, активному или регулярному публичному ключу, но не коммуникативному, так как коммуникативный ключ используется для шифрования сообщений, а не транзакций, например в заметке с переводом токенов. При подписи стоит учитывать, что у каждого ключа свой уровень доступа, то есть разные ключи отвечают за разные типы транзакций.

*Ниже в таблице описаны все ключи и операции, которые с помощью них можно совершать*

| Ключ            | Разрешения                                                   |
| --------------- | ------------------------------------------------------------ |
| Регулярный      | Отправка [сторонних транзакций](./vocabulary.html), награда пользователей, изменение метаданных аккаунта, любые действия с [комитетом.](./economy.html#committee) |
| Активный        | Все что можно делать с помощью регулярного ключа, вдобавок позволяет проводить операции с [активами](./economy.html#assets) и голосовать за [делегатов](./witnesses.html). То есть позволяет совершать активные действия в блокчейне VIZ, управлять им при помощи своей доли. |
| Главный         | Все что можно делать с помощью регулярного и активного, кроме того, с его помощью можно заменить ключи. |
| Коммуникативный | Не позволяет подписывать транзакции, но с его помощью можно засекречивать сообщения, например шифровать при помощи алгоритма [ECDH](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB_%D0%94%D0%B8%D1%84%D1%84%D0%B8_%E2%80%94_%D0%A5%D0%B5%D0%BB%D0%BB%D0%BC%D0%B0%D0%BD%D0%B0_%D0%BD%D0%B0_%D1%8D%D0%BB%D0%BB%D0%B8%D0%BF%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D1%85_%D0%BA%D1%80%D0%B8%D0%B2%D1%8B%D1%85) заметки с переводом токенов. |

## Аккаунт с несколькими пользователями

Если пользователь знает главный приватный ключ конкретного аккаунта, то он может добавить к учетной записи других пользователей. Чтобы это сделать, нужно или добавить к аккаунту еще один ключ: главный, активный или регулярный — и передать второму пользователю, или владелец может прописать в своей учетной записи главную, активную или регулярную роль для  другого аккаунта, то есть связать один аккаунт с другим. Отличие роли от ключей состоит лишь в том, владельцы привязанного аккаунта для подписи транзакций будут использовать свои приватные ключи. Отметим, что связывание аккаунтов - более гибкий способ добавления пользователей к главному аккаунту, так как привязав один аккаунт можно сразу же приписать полномочия группе людей.

Стоит учитывать, что пользователь, который получил дополнительный ключ или аккаунт, которому приписана одна из трех ролей, ничем не ограничены при подписи транзакций от имени главного аккаунта, кроме как уровнем доступа ключа или роли. То есть, если пользователю выделен главный ключ или аккаунту приписана главная роль, то и пользователь, и аккаунт смогут сами распределять уровни доступа к главному аккаунту для других участников ДАО VIZ,  и даже ограничить доступ первоначальному владельцу аккаунта.

## Мультиподпись

Чтобы избежать злоупотребления власти можно каждому пользователю или привязанному аккаунту установить свой вес, а каждому уровню доступа установить весовой порог, только при достижении которого можно будет отправить транзакцию. Для отправки транзакции ее придется подписать нескольким пользователям, тогда если сумма весов всех подписавших будет больше чем весовой порог или равна ему, то транзакция будет благополучно добавлена в блокчейн. Такая схема подписи называется - мультиподпись.

### Пример мультиподписи

Пусть в аккаунте с весовым порогом 100 прописано три пользователя: Алиса, Макс и Боб. У Боба будет вес 25 и у Макса будет — 25, а у Алисы вес будет 50. Тогда Бобу, чтобы отправить транзакцию, придется помимо своей подписи, попросить подпись у Алисы и Макса, ведь только тогда суммарный вес подписавшихся будет равен весовому порогу аккаунта 100. Аналогично нужно будет поступить Максу и Алисе, чтобы отправить транзакцию от имени аккаунта. Таким образом никто не сможет отправить транзакцию без соглашения всех участников, так можно избежать злоупотребление властью для каждого пользователя.

## Регистрация

Чтобы создать новый аккаунт в VIZ, нужно отправить специальную тразнакцию(account_create), которая зарегистрирует новую учетную запись. При этом отправитель транзакции должен заплатить за создание аккаунта сумму не меньшую, чем [указали делегаты](./witnesses.html#account_creation_fee), по умолчанию цена создания одного аккаунта равна 1 viz. Все ликвидные токены, которые заплатит регистратор будут конвертированы в Shares нового аккаунта.

Кроме прямого перевода ликвидных токенов есть еще два способа, которыми можно создать аккаунт: создание через инвайт код и регистрация через делегирование доли.

### Регистрация через делегирование доли

Чтобы не тратить ликвидные токены, регистратор может создать новый аккаунт делегированием. Для этого он должен так же отправить транзакцию, но указать в ней не количество ликвидных токенов, которые готов потратить, а количество долевых токенов, которые он готов делегировать. Стоимость в viz всех делегированных Shares не должно быть меньшим, чем [указали делегаты](./accounts.html#create_account_delegation_ratio), по умолчанию общая стоимость должна составляет 10 viz. Вместе с делегированием регистратор может потратить и ликвидные токены, они так же будут конвертированы в Shares нового аккаунта, но на цену транзакции не повлияют,  аккаунт будет создан или за viz или за Shares. Если количество viz достаточно для регистрации за ликвидные токены, то аккаунт будет создан за viz, если не достаточно, то за Shares. Если не достаточно и Shares, то аккаунт не будет создан вообще. Но в любом случае, при успехе, все токены и ликвидные, и долевые будут переведены на счет нового аккаунта.

### Регистрация через инвайт код

*Подробнее про инвайт коды читайте в разделе: [Инвайт коды](./invite.html).*

Еще один удобный способ создать новый аккаунт — регистрация через инвайт коды. Для этого регистратор должен сформировать инвайт код на сумму не меньшую, чем [указали делегаты](./witnesses.html#account_creation_fee), и пароль для него. Затем передать все это человеку, который хочет зарегистрировать аккаунт. После этот человек должен отправить специальную транзакцию(invite_registration), которая зарегистрирует новый аккаунт, потратив токены из инвайт кода. Если у человека уже есть аккаунт, то он может отправить транзакцию с помощью своей учетной записи и своего активного приватного ключа. Если у него еще нет аккаунта то можно отправить транзакцию с помощью аккаунта @invite, который принадлежит блокчейну, подписав ее приватным ключом ``5KcfoRuDfkhrLCxVcE9x51J6KN9aM9fpb78tLrvvFckxVV6FyFW``. При таком способе регистрации все токены так же будут конвертированы в Shares нового аккаунта. Однако стоить учитывать, что при таком способе, владелец пароля от инвайт кода может потратить средства инвайта не на регистрацию аккаунта, а на перевод средства на уже существующий аккаунт.

<span id="energy"></span>

## Энергия

У каждого аккаунта в блокчейне есть запас энергии, который измеряется в процентах. Максимальное значение энергии 100% минимальное же может быть -327,68%, то есть меньше 0%. Энергия нужна для того, чтобы отправлять [награды](./economy.html#awards) другим пользователям, если энергии не хватает, то аккаунт не сможет наградить участника необходимой суммой токенов, а если энергия равно 0, то аккаунт вообще не сможет отправить наград, но он по прежнему сможет совершать другие операции в блокчейне, например, он будет способен переводить токены между аккаунтами, голосовать за делегатов и делать все, что мог со 100% энергии. Подробнее про награды читайте в разделе [Награды за деятельность](./ecomomy.html#award).

Энергия тратится в двух случаях. Во-первых, когда аккаунт награждает участника, тогда пользователь сам указывает какое количество хочет потратит, и от этого количества зависит размер награды. Во-вторых, когда аккаунт [делегирует Shares](./economy.html#shares) другому пользователю. Делегирование происходит в двух случаях: при регистрации аккаунта через делегирование и при делегировании доли уже существующему аккаунту. При любом способе делегирования инициатор не может сам указать количество энергии, которое будет затрачена, но оно прямо пропорционально количеству Shres, которое будет отправлено (чем больше Shares будет делегировано, тем больше будет затрачено энергии). Блокчейн рассчитывает количество, которое будет затрачено, по формуле ``делегировано shares / эффективные shares * 100%``. Каким бы способом аккаунт не расходовал энергию, ее количество влияет только на возможность отправляется награды другим участникам.

Тратиться энергия моментально, но восстанавливается она медленно: 20% за 24 часа, 1% за 1.2 часа и за 1 секунду восстанавливается всего 0.01% энергии.